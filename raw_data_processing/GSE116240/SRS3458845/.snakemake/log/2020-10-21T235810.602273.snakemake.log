Building DAG of jobs...
Singularity image location: /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	add_uns_to_h5ad
	1	all
	1	define_version
	1	download_bam_header
	1	get_count_matrix
	1	kallisto
	1	run_analysis
	7
Resources before job selection: {'_cores': 4, '_nodes': 9223372036854775807}
Ready jobs (1):
	download_bam_header
Selected jobs (1):
	download_bam_header
Resources after job selection: {'_cores': 3, '_nodes': 9223372036854775806}

[Wed Oct 21 23:58:11 2020]
rule download_bam_header:
    output: file.bam
    log: logs/download_bam_header.log
    jobid: 6
    benchmark: benchmarks/download_bam_header.txt

 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'type conda'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'conda --version'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'conda info --json'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'type conda'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'conda --version'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845  --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg sh -c 'conda info --json'
 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'source /opt/conda/bin/activate '\''/mnt/tank/scratch/mfiruleva/scn/config/65ef9760'\''; set -euo pipefail;  wget -q -O - ftp://ftp.sra.ebi.ac.uk/vol1/SRA728/SRA728071/bam/total_foam.bam | head -1000 > file.bam || true'
Activating singularity image /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg
Activating conda environment: /mnt/tank/scratch/mfiruleva/scn/config/65ef9760
[Wed Oct 21 23:59:11 2020]
Finished job 6.
1 of 7 steps (14%) done
Resources before job selection: {'_cores': 4, '_nodes': 9223372036854775807}
Ready jobs (1):
	define_version
Selected jobs (1):
	define_version
Resources after job selection: {'_cores': 3, '_nodes': 9223372036854775806}

[Wed Oct 21 23:59:11 2020]
rule define_version:
    input: file.bam, sample_description.csv
    output: kallisto.sh
    log: logs/define_version.log
    jobid: 5
    benchmark: benchmarks/define_version.txt

 singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'set -euo pipefail;  python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt'
Activating singularity image /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg
Full Traceback (most recent call last):
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/executors.py", line 2078, in run_wrapper
    run(
  File "/mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk", line 46, in __rule_define_version
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/shell.py", line 176, in __new__
    raise sp.CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command ' singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'set -euo pipefail;  python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt'' returned non-zero exit status 1.

[Wed Oct 21 23:59:17 2020]
Error in rule define_version:
    jobid: 5
    output: kallisto.sh
    log: logs/define_version.log (check log file(s) for error message)
    shell:
        
        python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Full Traceback (most recent call last):
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/executors.py", line 2078, in run_wrapper
    run(
  File "/mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk", line 46, in __rule_define_version
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/shell.py", line 176, in __new__
    raise sp.CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command ' singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'set -euo pipefail;  python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt'' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/executors.py", line 493, in _callback
    raise ex
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/executors.py", line 479, in cached_or_run
    run_func(*args)
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages/snakemake/executors.py", line 2160, in run_wrapper
    raise RuleException(
snakemake.exceptions.RuleException: CalledProcessError in line 24 of /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk:
Command ' singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'set -euo pipefail;  python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt'' returned non-zero exit status 1.
  File "/mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk", line 24, in __rule_define_version

RuleException:
CalledProcessError in line 24 of /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk:
Command ' singularity exec --home /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845 --bind /scratch/mfiruleva/winter/genomes/mus:/home --bind /scratch/mfiruleva/GSEs_processing/wget_and_process:/files --bind /mnt/tank/scratch/mfiruleva/scn/config/65ef9760:/mnt/tank/scratch/mfiruleva/scn/config/65ef9760 --bind /mnt/tank/scratch/mfiruleva/scn/stats/summary.csv:/mnt/tank/scratch/mfiruleva/scn/stats/summary.csv --bind /nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/site-packages:/mnt/snakemake /mnt/tank/scratch/mfiruleva/scn/config/sin/e78b32002e592105c700c757fbe8a8e4.simg bash -c 'set -euo pipefail;  python scripts/define_version.py --s_d sample_description.csv --tmp_bam file.bam         --threads 1 --index /home/Mus_musculus.GRCm38.cdna.all.idx --transcripts_to_genes /home/transcripts_to_genes_v2.txt         --white_10xv1 /files/10xv1_whitelist.txt --white_10xv2 /files/10xv2_whitelist.txt --white_10xv3 /files/10xv3_whitelist.txt'' returned non-zero exit status 1.
  File "/mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/rules/define_version.smk", line 24, in __rule_define_version
  File "/nfs/home/mfiruleva/anaconda3/envs/scn_cor/lib/python3.8/concurrent/futures/thread.py", line 57, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /mnt/tank/scratch/mfiruleva/scn/data/GSE116240/SRS3458845/.snakemake/log/2020-10-21T235810.602273.snakemake.log
unlocking
removing lock
removing lock
removed all locks
